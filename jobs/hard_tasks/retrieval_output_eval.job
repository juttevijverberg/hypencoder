#!/bin/bash

#SBATCH --partition=gpu_mig
#SBATCH --gpus=1
#SBATCH --job-name=retrieval_output_eval
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=9
#SBATCH --time=00:05:00
#SBATCH --output=outputs/retrieval_output_eval.out

module purge
module load 2023
module load Anaconda3/2023.07-2
source activate hype

export ORIGINAL_RUN_PATH="/home/scur1744/hypencoder/retrieval_outputs/og_hypencoder.6_layer_retrieved_items.jsonl"

python hypencoder_cb/inference/retrieve_eval.py \
    --retrieval_path="/home/scur1744/hypencoder/retrieval_outputs/dlhard_og_hypencoder_retrieval.jsonl" \
    --output_dir="/home/scur1744/hypencoder/retrieval_outputs/eval_og_results/dlhard_og_hypencoder_retrieval" \
    --ir_dataset_name="msmarco-passage/trec-dl-hard" \
    --metric_names='("nDCG@10", "RR", "R@1000", "nDCG@1000")'

python hypencoder_cb/inference/retrieve_eval.py \
    --retrieval_path="/home/scur1744/hypencoder/retrieval_outputs/tot_og_hypencoder_retrieval.jsonl" \
    --output_dir="/home/scur1744/hypencoder/retrieval_outputs/eval_og_results/tot_og_hypencoder_retrieval" \
    --ir_dataset_name="trec-tot/2023/dev" \
    --metric_names='("nDCG@10", "RR", "R@1000", "nDCG@1000")'


